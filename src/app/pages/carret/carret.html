<div class="max-w-4xl mx-auto p-4 md:p-8">
  <h1 class="text-3xl font-bold mb-6">El teu Carret</h1>

  @if(errorMessage){
    <div class="p-4 mb-4 bg-red-100 text-red-700 rounded border border-red-400">
      {{ errorMessage }}
    </div>
  }
  <div *ngIf="successMessage" class="p-4 mb-4 bg-green-100 text-green-700 rounded border border-green-400">
    {{ successMessage }}
  </div>

  <div class="bg-white shadow-md rounded-lg">
    
    <div class="divide-y divide-gray-200">

      <div *ngIf="items.length === 0" class="p-8 text-center text-gray-500">
      <p>El teu carret està buit.</p>
        <a routerLink="/" class="text-[#8B6E5B] hover:underline mt-2 inline-block">Torna a la botiga</a>
      </div>

      @for(item of items; track $index){
        <div class="flex flex-col md:flex-row items-center p-4">
        
        <a [routerLink]="['/viatge', item.viatge.id]" class="w-32 h-20 bg-gray-100 rounded-md overflow-hidden flex-shrink-0">
          <img [src]="item.viatge.imatge_principal ? 'http://127.0.0.1:8000/storage/' + item.viatge.imatge_principal : 'https://via.placeholder.com/150x100.png?text=TrekReplay'" 
               alt="{{ item.viatge.titol }}"
               class="w-full h-full object-cover">
        </a>
        
        <div class="flex-grow p-4 text-center md:text-left">
          <h2 class="font-bold text-lg">
            <a [routerLink]="['/viatge', item.viatge.id]">{{ item.viatge.titol }}</a>
          </h2>
          <p class="text-sm text-gray-500">Paquet Tancat</p>
        </div>
        
        <div class="text-xl font-semibold p-4">
          €{{ item.viatge.preu }}
        </div>

        <div class="p-4">
          <button (click)="esborrarItem(item.viatge.id)" 
                  class="text-red-500 hover:text-red-700 font-medium text-sm">
            Esborrar
          </button>
        </div>
        </div>
      }
    </div>

    <div *ngIf="items.length > 0" class="bg-gray-50 p-6 rounded-b-lg">
      <div class="flex justify-end items-center">
        <span class="text-xl font-bold text-gray-800">Total: €{{ calcularTotal() }}</span>
      </div>
      <div class="flex justify-end mt-4">
        <button class="w-full md:w-auto bg-black text-white py-3 px-8 rounded-lg font-semibold hover:bg-gray-800 transition-colors">
          Anar al Pagament (Simulat)
        </button>
      </div>
    </div>

  </div>
</div>